# Подключение облачных AI API

## Зачем нужны облачные API?

**Проблемы с локальным Ollama (llama3.2)**:
- ⚠️ Слабое качество (1-2 файла из 5 обрабатываются)
- ⚠️ Долгая обработка (60-200 секунд на файл)
- ⚠️ Ошибки парсинга JSON
- ⚠️ Неполный текст в ответах

**Преимущества облачных API**:
- ✅ Отличное качество (4-5 файлов из 5)
- ✅ Быстрая обработка (5-15 секунд на файл)
- ✅ Стабильный JSON
- ✅ Качественное исправление OCR

## Стоимость

### OpenAI GPT-4o-mini (рекомендуется):
- **Цена**: ~$0.03 за 5 фотографий
- **Скорость**: 5-10 секунд на файл
- **Качество**: Отличное
- **Итого**: ~$0.60 для 100 фотографий

### Anthropic Claude 3.5 Sonnet:
- **Цена**: ~$0.06 за 5 фотографий
- **Скорость**: 5-10 секунд на файл
- **Качество**: Отличное
- **Итого**: ~$1.20 для 100 фотографий

## Как подключить

### Шаг 1: Выберите провайдера

#### Вариант A: OpenAI (проще, дешевле)

1. Зарегистрируйтесь на https://platform.openai.com/
2. Перейдите в https://platform.openai.com/api-keys
3. Нажмите "Create new secret key"
4. Скопируйте ключ (начинается с `sk-`)
5. Пополните баланс: https://platform.openai.com/settings/organization/billing
   - Минимум: $5
   - Рекомендуется: $10

#### Вариант B: Anthropic Claude

1. Зарегистрируйтесь на https://console.anthropic.com/
2. Перейдите в Settings → API Keys
3. Создайте новый ключ
4. Скопируйте ключ (начинается с `sk-ant-`)
5. Пополните баланс в биллинге

### Шаг 2: Настройте config.json

1. Скопируйте `config_example.json` → `config.json`:
   ```bash
   cp config_example.json config.json
   ```

2. Откройте `config.json` в текстовом редакторе

3. **Для OpenAI**:
   ```json
   {
     "ai_provider": "openai",
     "openai": {
       "api_key": "sk-proj-ВАШ_КЛЮЧ_СЮДА",
       "model": "gpt-4o-mini"
     }
   }
   ```

4. **Для Anthropic**:
   ```json
   {
     "ai_provider": "anthropic",
     "anthropic": {
       "api_key": "sk-ant-ВАШ_КЛЮЧ_СЮДА",
       "model": "claude-3-5-sonnet-20241022"
     }
   }
   ```

5. Сохраните файл

### Шаг 3: Установите зависимости

```bash
pip install openai anthropic
```

### Шаг 4: Запустите программу

```bash
python audit_processor.py
```

Программа автоматически определит провайдера из `config.json`!

## Рекомендации моделей

### OpenAI (рекомендуется для начала):
- `gpt-4o-mini` - дешево, быстро, отлично для OCR ✅
- `gpt-4o` - дороже, но еще лучше качество
- `gpt-4-turbo` - альтернатива

### Anthropic:
- `claude-3-5-sonnet-20241022` - топовая модель ✅
- `claude-3-opus` - самое высокое качество, дорого
- `claude-3-haiku` - быстро и дешево

## Проверка работы

После настройки запустите программу. Вы увидите:

```
✅ OpenAI API подключен (gpt-4o-mini)
```
или
```
✅ Anthropic API подключен (claude-3-5-sonnet)
```

Обработка 5 фотографий займет ~30-60 секунд (вместо 10-13 минут)!

## Безопасность

⚠️ **ВАЖНО**:
- Не добавляйте `config.json` в git (уже в .gitignore)
- Не делитесь API ключами
- Храните ключи в секрете

## Откат на Ollama

Если хотите вернуться на локальную модель:

```json
{
  "ai_provider": "ollama"
}
```

## Поддержка

Проблемы? Проверьте:
- API ключ правильный
- Есть баланс на счету
- Есть интернет
- Установлены библиотеки: `pip install openai anthropic`
